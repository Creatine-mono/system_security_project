#!/usr/bin/env python3
"""Test script for exploit availability tool"""

import asyncio
import sys
from pathlib import Path

import pytest

# Add parent directory to path so we can import mcp_simple_tool
sys.path.append(str(Path(__file__).parent.parent))

from mcp_simple_tool.tools.exploit_availability import get_exploit_availability


@pytest.mark.asyncio
async def test_exploit():
    """Test the exploit availability checker tool"""
    print("Testing exploit availability checker with CVE-2021-44228 (Log4Shell)...")
    result = await get_exploit_availability("CVE-2021-44228")
    print("\n" + "=" * 60)
    print(result[0].text)
    print("=" * 60)


if __name__ == "__main__":
    asyncio.run(test_exploit())
